<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd" >
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <!-- Style -->
    <link rel="stylesheet" type="text/css" media="all" href="layout.css"/>

    <title>WeX AR Application</title>

</head>

<body>
<div id="wrapper">
    <div id="content">
        <div id="renderArea">
            <canvas id="background"></canvas>

            <xml3d xmlns="http://www.xml3d.org/2009/xml3d"
                   style="background: rgba(0,0,0,0); position: absolute; top: 0; width: 640px; height: 480px;">

                <data id="arBase">
                    <data compute="flipvideo = xflow.flipVerticalImage(arvideo)">
                        <texture name="arvideo">
                            <video autoplay="false"/>
                        </texture>
                    </data>
                </data>

                <view id="View" perspective="#arBase"/>
                <view position="0 0 70" />

                <data id="obj1AR" compute="transform = xflow.selectTransform(index, transforms)">
                    <bool name="visibility">true</bool>
                    <data compute="visibility = xflow.selectBool(index, visibilities)">
                        <int name="index">0</int>
                        <data src="#arBase"/>
                    </data>

                </data>

                <shader id="obj1Shader" script="urn:xml3d:shader:phongvs">
                    <float3 name="diffuseColor">1.0 0.4 0.2</float3>
                    <float name="ambientIntensity">0.2</float>

                    <data filter="keep(visibility)" src="#obj1AR"/>
                    <bool name="visibility">true</bool>
                </shader>


                <transform id="t_square_ar"/>
                <transform id="t_square_local"/>

                <group transform="#t_square_ar" shader="#obj1Shader">
                    <group transform="#t_square_local">
                        <group style="transform: rotateX(0deg) scale(100,100,100) translate3d(0px, 0px, -20px)">
                            <group id="twitter" transform="assets/twitter.xml#t_twitter"
                                   onclick="console.log('clicked twitter')" onmouseover="console.log('Mouse on Twitter!')">
                                <group shader="assets/twitter.xml#twitter_0">
                                    <mesh src="assets/twitter.xml#mesh_twitter_twitter_0" type="triangles"/>
                                </group>
                                <group shader="assets/twitter.xml#twitter_1">
                                    <mesh src="assets/twitter.xml#mesh_twitter_twitter_1" type="triangles"/>
                                </group>
                            </group>
                        </group>
                    </group>
                </group>

                <lightshader id="light1" script="urn:xml3d:lightshader:point">
                    <float3 name="intensity">1 1 1</float3>
                    <float3 name="attenuation">1 0 0</float3>
                    <bool name="castShadow">true</bool>
                </lightshader>

                <group style="transform: translate3d(0px, 10px, 0px)">
                    <light shader="#light1"/>
                </group>

                <group style="transform: translate3d(5px, 10px, 0px)">
                    <light shader="#light1"/>
                </group>
            </xml3d>

        </div>
        <div id="buttons">
            <p><label><input type="checkbox" id="button1"/>Toggle Webcam</label></p>
        </div>
        <div id="infoPanel">
        </div>

    </div>
    <div id="footer">
        <div id="log"></div>
    </div>

</div>

<!-- Dependencies -->
<script type="text/javascript" src="../../deps/js/xml3d.js"></script>
<script type="text/javascript" src="../../deps/js/gl-matrix.js"></script>
<script type="text/javascript" src="../../deps/js/Signals.js"></script>
<script type="text/javascript" src="../../deps/js/Util.js"></script>

<!-- Application Scrips -->
<script type="text/javascript" src="js/WeXAR/JSARToolKit.js"></script>
<script type="text/javascript" src="js/WeXAR/xflar.js"></script>
<script type="text/javascript" src="js/WeXAR/phongvs.js"></script>
<script type="text/javascript" src="js/WeXAR/Namespace.js"></script>
<script type="text/javascript" src="js/WeXAR/Framework.js"></script>
<script type="text/javascript" src="js/WeXAR/WSManager.js"></script>
<script type="text/javascript" src="js/WeXAR/SensorManager.js"></script>
<script type="text/javascript" src="js/WeXAR/AssetManager.js"></script>

<script type="text/javascript" src="js/main.js"></script>


</body>

</html>